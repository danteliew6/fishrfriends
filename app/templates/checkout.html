{% extends "base.html" %}
{% block title %} Paypal Checkout {% endblock %}
{%block content%} 

<!-- This script tag is the payment id of the merchant in out case the FISHRFRIENDS Enterprise -->
<script src="https://www.paypal.com/sdk/js?client-id=AeKkXHKQFzgRzsn8DD3p0MXMZbQN86DaBS9YUDCv5pvbP8r7j6tSiYpyIo6u9yzkm6qe0dN0yWvxWC20"> // Replace YOUR_CLIENT_ID with your sandbox client ID
</script>


<h1>The total price is ${{data['price']}} the breakdown is as shown below:</h1>
<p id = 'hidden-dollars'>{{data['price']}}</p>
<table class="table table-bordered">
  <thead>
    <tr>
      <th scope="col">Fish ID</th>
      <th scope="col">Quantity</th>
      <th scope="col">Price</th>
    </tr>
  </thead>
  <tbody>
    {% for fishes in data['orders'] %}
    {% if fishes.quantity != '0' %}
    <tr>
      <td>{{fishes.fish_id}}</td>
      <td>{{fishes.quantity}}</td>
      <td>${{fishes.price}}</td>
    </tr>
    {% endif %}
    {% endfor %}

  </tbody>
</table>


<div id="paypal-button-container">

</div>



<!-- Add the checkout buttons, set up the order and approve the order -->
<script>
  var total_price = document.getElementById('hidden-dollars').innerHTML;

  paypal.Buttons({
    createOrder: function(data, actions) {
      return actions.order.create({
        purchase_units: [{
          amount: {
            value: total_price
          }
        }]
      });
    },
    onApprove: function(data, actions) {
      return actions.order.capture().then(function(details) {
        alert('Transaction completed by ' + details.payer.name.given_name);

      });
    }
  }).render('#paypal-button-container'); // Display payment options on your web page
</script>

{% endblock %}
